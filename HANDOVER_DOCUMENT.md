# Dietary AI Compliance Dashboard - Handover Documentation

## 1. Project Overview & Purpose
The **Dietary AI Compliance Dashboard** is a specialized Next.js application designed to act as an intelligent safety layer for clinical nutritionists. Its primary function is to automatically audit diet plans against detailed client health profiles to detect potential conflicts before they reach the patient. By cross-referencing proposed meal plans with a client's specific allergies (e.g., nuts, gluten), medical conditions (e.g., diabetes, hypertension), food aversions, and dietary preferences (e.g., Vegan, Jain, Non-Veg), the system prevents dangerous or non-compliant food assignments. This proactive auditing tool significantly enhances patient safety, ensures strict adherence to medical dietary restrictions, and reduces operational liability for the nutrition platform.

## 2. Technical Architecture & Implementation
The system is built on a modern **Next.js 14** stack, operating as a separate frontend service that interfaces with the existing Balance Nutrition backend via secure, server-side API endpoints. It leverages the **Vercel AI SDK** to integrate **Google's Gemini 1.5 Flash** model as the core reasoning engine, chosen for its speed and logical capabilities. The application employs a sophisticated "Audit Orchestrator" (server action) that executes a multi-step workflow: first, it fetches and sanitizes raw HTML diet templates to strip marketing metadata and URLs; second, it enriches isolated dish names by querying a dedicated **Recipe API** to retrieve granular ingredient breakdowns. This enriched context is then fed into the AI with a strictly engineered, deterministic system prompt (Temperature 0.0) that enforces hierarchical decision-making logic to minimize hallucinations and ensure precise compliance checking.

## 3. Data Pipeline & Coverage
The project's data pipeline is robustly designed to handle real-world data variability and ensure comprehensive coverage of all client constraints. Not merely a text matcher, the pipeline implements:
*   **Normalization**: It aggressively normalizes inconsistent API field names (e.g., unifying `eating_habit`, `diet_type`, and `food_preference`) to ensure no client constraint is missed.
*   **Deep Ingredient Analysis**: It does not just check dish names but looks up underlying ingredients (e.g., flagging "Pesto" for a "Nut Allergy" due to pine nuts).
*   **Strict Logic Rules**: It covers the full spectrum of restrictions by strictly enforcing biological classifications for diet types (discriminating between Vegan, Lacto-Vegetarian, and Non-Veg), applying **zero-tolerance rules** for allergens (including derivatives like "whey" for dairy allergies), and respecting specific food aversions.
*   **Visual Feedback Loop**: The pipeline concludes by injecting conflict data back into the UI, dynamically rendering color-coded warnings (**Red** for Allergies, **Orange** for Aversions, **Amber** for Diet Violations) directly within the diet template view for immediate user action.
